# Лабораторна робота №3: Розробка RESTful веб-сервісів

## Мета роботи:
Ознайомлення з принципами розробки RESTful веб-сервісів. Навчитися створювати веб-сервіси, що відповідають архітектурному стилю REST.

## Теоретичні відомості
REST (Representational State Transfer) – це архітектурний стиль, що визначає принципи взаємодії компонентів у розподілених системах, зокрема в мережі Інтернет. Веб-сервіси, розроблені згідно з REST (RESTful веб-сервіси), використовують стандартний протокол HTTP для комунікації. Ключовими аспектами REST є:
*   **Ресурси**: Основна концепція в REST – це ресурс, який може бути будь-яким об'єктом або інформацією, до якої можна звернутися (наприклад, користувач, подія, документ). Кожен ресурс ідентифікується унікальним URI (Uniform Resource Identifier).
*   **HTTP методи**: Взаємодія з ресурсами відбувається за допомогою стандартних HTTP методів:
    *   `GET`: Отримання представлення ресурсу.
    *   `POST`: Створення нового ресурсу.
    *   `PUT`: Оновлення існуючого ресурсу (повне оновлення).
    *   `PATCH`: Часткове оновлення існуючого ресурсу.
    *   `DELETE`: Видалення ресурсу.
*   **Представлення (Representations)**: Ресурси можуть мати різні представлення (наприклад, JSON, XML, HTML). Клієнт та сервер домовляються про формат представлення через HTTP заголовки (наприклад, `Accept` та `Content-Type`).
*   **Stateless (Без стану)**: Кожен запит від клієнта до сервера повинен містити всю необхідну інформацію для його обробки. Сервер не зберігає стан клієнта між запитами. Це спрощує масштабування та надійність системи.
*   **Кешування**: HTTP надає механізми кешування, які можуть бути використані для підвищення продуктивності.

RESTful веб-сервіси широко використовуються для побудови API (Application Programming Interfaces), що дозволяють різним програмним системам взаємодіяти між собою.

## Практичне завдання
1.  **Вибір інструментів**: Виберіть фреймворк для розробки RESTful веб-сервісу, наприклад, Spring Boot для Java або Flask для Python.
2.  **Розробка веб-сервісу**: Створіть RESTful веб-сервіс, який надає API для виконання базових операцій над ресурсами (CRUD - створення, читання, оновлення, видалення).
3.  **Робота з форматами даних**: Реалізуйте прийом та відправлення даних у форматах JSON.
4.  **Тестування веб-сервісу**: Використовуйте Postman або аналогічні інструменти для тестування API вашого веб-сервісу. Перевірте різні HTTP методи та відповіді сервера.

## Опис реалізації проекту

### 1. Вибір інструментів
Для реалізації даного RESTful веб-сервісу було обрано мову програмування **Go (Golang)**. Go надає потужну стандартну бібліотеку `net/http` для побудови веб-серверів, а також ефективні засоби для роботи з JSON (`encoding/json`). Це дозволяє створювати високопродуктивні та масштабовані веб-сервіси без необхідності використання великих сторонніх фреймворків, хоча для складніших завдань маршрутизації можуть використовуватися пакети, такі як `gorilla/mux` або `gin-gonic`. У даному проекті, судячи зі структури, акцент зроблено на використанні стандартних можливостей Go та чіткому розділенні відповідальності між модулями.

Файли `go.mod` та `go.sum` керують залежностями проекту, забезпечуючи відтворюваність збірки та версіонування використовуваних бібліотек.

### 2. Структура проекту
Проект має наступну структуру, що відображає логічне розділення компонентів системи:

```
.
├── api.db          # Файл бази даних SQLite
├── go.mod          # Файл визначення модуля Go та його залежностей
├── go.sum          # Контрольні суми залежностей
├── main.go         # Вхідна точка програми, ініціалізація сервера
├── db/
│   └── db.go       # Модуль для ініціалізації та роботи з базою даних
├── middlewares/
│   └── auth.go     # Модуль для проміжного ПЗ (наприклад, автентифікація JWT)
├── models/
│   ├── event.go    # Модель даних для "Події"
│   └── user.go     # Модель даних для "Користувача"
├── routes/
│   ├── events.go   # Обробники HTTP-запитів для ресурсу "Події"
│   ├── register.go # Обробник для реєстрації користувачів
│   ├── router.go   # Конфігурація основного маршрутизатора
│   └── users.go    # Обробники HTTP-запитів для ресурсу "Користувачі"
└── utils/
    ├── hash.go     # Утиліти для хешування (наприклад, паролів)
    └── jwt.go      # Утиліти для роботи з JWT (генерація, валідація)
```

**Опис ключових компонентів:**
*   `main.go`: Ініціалізує підключення до бази даних, налаштовує маршрутизатор, використовуючи функції з `routes/router.go`, та запускає HTTP-сервер.
*   `db/db.go`: Відповідає за встановлення з'єднання з базою даних SQLite (`api.db`) та, можливо, за виконання міграцій схеми бази даних.
*   `models/`: Містить визначення структур Go, що представляють сутності даних (ресурси), якими оперує API. `event.go` описує структуру для подій, а `user.go` – для користувачів. Ці структури використовуються для взаємодії з базою даних та для серіалізації/десеріалізації JSON.
*   `routes/`: Ця директорія містить логіку обробки HTTP-запитів для різних ендпоінтів.
    *   `router.go`: Збирає всі маршрути та прив'язує їх до відповідних функцій-обробників.
    *   `events.go`, `users.go`, `register.go`: Містять функції-обробники для конкретних шляхів API, що реалізують CRUD-операції та іншу логіку (наприклад, реєстрацію).
*   `middlewares/auth.go`: Реалізує проміжне програмне забезпечення, яке виконується перед основними обробниками запитів. У даному випадку, ймовірно, для перевірки JWT токенів автентифікації та авторизації доступу до захищених ресурсів.
*   `utils/`: Надає допоміжні функції, що використовуються в різних частинах програми:
    *   `hash.go`: Для безпечного зберігання паролів шляхом їх хешування.
    *   `jwt.go`: Для генерації JWT токенів під час логіну та їх валідації при доступі до захищених ендпоінтів.

### 3. Розробка веб-сервісу та CRUD операції
Веб-сервіс надає API для управління двома основними ресурсами: **Події (Events)** та **Користувачі (Users)**. Для цих ресурсів реалізовані стандартні CRUD операції:

*   **Create (Створення)**:
    *   Реєстрація нового користувача (ймовірно, `POST /signup` або `POST /register`).
    *   Створення нової події (ймовірно, `POST /events`, потребує автентифікації).
*   **Read (Читання)**:
    *   Отримання списку всіх подій (`GET /events`).
    *   Отримання детальної інформації про конкретну подію за її ID (`GET /events/{eventId}`).
    *   Отримання списку користувачів (можливо, `GET /users`, захищено адміністратором).
    *   Отримання інформації про конкретного користувача (`GET /users/{userId}`).
*   **Update (Оновлення)**:
    *   Оновлення інформації про існуючу подію (`PUT /events/{eventId}`, потребує автентифікації та авторизації).
    *   Оновлення інформації про користувача (`PUT /users/{userId}`).
*   **Delete (Видалення)**:
    *   Видалення події (`DELETE /events/{eventId}`, потребує автентифікації та авторизації).
    *   Видалення користувача (`DELETE /users/{userId}`).

Окрім базових CRUD, реалізовано функціонал реєстрації користувачів (`routes/register.go`) та, ймовірно, логіну для отримання JWT токена, який потім використовується для доступу до захищених маршрутів.

### 4. Робота з форматами даних (JSON)
Сервіс використовує JSON як основний формат для обміну даними.
*   **Прийом даних**: Тіло HTTP-запитів (наприклад, для `POST` та `PUT` методів) очікується у форматі JSON. Стандартний пакет `encoding/json` (функція `json.Unmarshal`) використовується для десеріалізації JSON-даних у відповідні структури Go (визначені в `models/`).
*   **Відправлення даних**: Відповіді сервера, що містять дані (наприклад, для `GET` запитів або при успішному створенні/оновленні ресурсу), також формуються у форматі JSON. Пакет `encoding/json` (функція `json.Marshal`) використовується для серіалізації структур Go у JSON-рядок.
HTTP заголовки `Content-Type: application/json` та `Accept: application/json` використовуються для коректної обробки JSON-даних.

### 5. Основні ендпоінти API (припущення)
На основі структури проекту, можна припустити наступні основні ендпоінти:

*   **Автентифікація та Реєстрація:**
    *   `POST /signup` (або `/register`): Створення нового облікового запису користувача. Обробник: `routes/register.go`.
    *   `POST /login`: Автентифікація існуючого користувача та видача JWT. Обробник: ймовірно, в `routes/users.go` або окремому файлі `auth.go`.
*   **Події (Events):** Обробники в `routes/events.go`.
    *   `GET /events`: Отримати список всіх подій.
    *   `POST /events`: Створити нову подію (потребує автентифікації).
    *   `GET /events/{id}`: Отримати деталі конкретної події.
    *   `PUT /events/{id}`: Оновити існуючу подію (потребує автентифікації та прав доступу).
    *   `DELETE /events/{id}`: Видалити подію (потребує автентифікації та прав доступу).
    *   `POST /events/{id}/register`: Дозволяє зареєстрованому користувачеві записатися на подію.
*   **Користувачі (Users):** Обробники в `routes/users.go`.
    *   `GET /users`: Отримати список користувачів (може бути обмежено для адміністраторів).
    *   `GET /users/{id}`: Отримати деталі конкретного користувача.
    *   `PUT /users/{id}`: Оновити дані користувача (потребує автентифікації, користувач може оновлювати свої дані).
    *   `DELETE /users/{id}`: Видалити користувача (може бути обмежено для адміністраторів або сам користувач може видалити свій акаунт).

### 6. Тестування веб-сервісу
Тестування RESTful API є критично важливим етапом розробки. Для даного проекту воно б включало використання інструментів, таких як Postman, Insomnia або `curl`.

**Основні сценарії тестування:**

1.  **Реєстрація та автентифікація:**
    *   Надсилання `POST` запиту на `/signup` з коректними даними користувача. Перевірка відповіді (`201 Created`).
    *   Спроба реєстрації з невалідними даними (наприклад, порожній email, короткий пароль). Перевірка відповіді (`400 Bad Request`) та повідомлень про помилки.
    *   Спроба реєстрації з існуючим email. Перевірка відповіді (наприклад, `409 Conflict`).
    *   Надсилання `POST` запиту на `/login` з коректними обліковими даними. Перевірка відповіді (`200 OK`) та наявності JWT токена.
    *   Спроба логіну з невірним паролем або неіснуючим користувачем. Перевірка відповіді (`401 Unauthorized`).

2.  **Операції з подіями (Events):**
    *   **Створення (`POST /events`):**
        *   Без JWT токена: очікується `401 Unauthorized`.
        *   З валідним JWT токеном та коректними даними події: очікується `201 Created` та повернення створеної події.
        *   З невалідними даними події: очікується `400 Bad Request`.
    *   **Читання (`GET /events`, `GET /events/{id}`):**
        *   Перевірка отримання списку подій та конкретної події. Очікується `200 OK`.
        *   Запит неіснуючої події: очікується `404 Not Found`.
    *   **Оновлення (`PUT /events/{id}`):**
        *   Без JWT або з токеном іншого користувача (якщо немає прав): `401 Unauthorized` або `403 Forbidden`.
        *   З валідним JWT (власника події) та коректними даними: `200 OK`.
        *   Спроба оновити неіснуючу подію: `404 Not Found`.
    *   **Видалення (`DELETE /events/{id}`):**
        *   Аналогічно до оновлення щодо прав доступу.
        *   Успішне видалення: `200 OK` або `204 No Content`.
        *   Спроба видалити неіснуючу подію: `404 Not Found`.
    *   **Реєстрація на подію (`POST /events/{id}/register`):**
        *   Без JWT: `401 Unauthorized`.
        *   З валідним JWT: `200 OK` або `201 Created`.
        *   Спроба реєстрації на неіснуючу подію: `404 Not Found`.
        *   Спроба повторної реєстрації (якщо не дозволено): `409 Conflict`.

3.  **Операції з користувачами (Users):** (якщо відповідні ендпоінти реалізовані та доступні)
    *   Тестування аналогічне до операцій з подіями, враховуючи права доступу (наприклад, чи може звичайний користувач отримувати список всіх користувачів або видаляти інших).

4.  **Перевірка заголовків:**
    *   `Content-Type` та `Accept` для JSON.

5.  **Перевірка кодів стану HTTP:**
    *   Коректність кодів для успішних операцій (`200`, `201`, `204`).
    *   Коректність кодів для помилок клієнта (`400`, `401`, `403`, `404`, `409`).
    *   Коректність кодів для помилок сервера (`500 Internal Server Error`) у разі непередбачених ситуацій.

## Висновки
В ході виконання даної лабораторної роботи було поглиблено знання про архітектурний стиль REST та отримано практичний досвід у розробці RESTful веб-сервісів з використанням мови програмування Go.

Було реалізовано веб-сервіс, що надає API для управління ресурсами "Події" та "Користувачі", включаючи операції CRUD, реєстрацію та автентифікацію користувачів за допомогою JWT. Проектна структура з чітким розділенням на модулі (`models`, `routes`, `db`, `middlewares`, `utils`) сприяла кращій організації коду та його подальшій підтримці.

Особливу увагу було приділено роботі з форматом даних JSON для обміну інформацією між клієнтом та сервером, а також реалізації механізмів безпеки, таких як хешування паролів та використання JWT для захисту ендпоінтів.

Було розглянуто та описано методику тестування розробленого API за допомогою інструментів типу Postman, що є невід'ємною частиною процесу розробки для забезпечення якості та надійності веб-сервісу.

Дана лабораторна робота дозволила закріпити теоретичні знання та набути цінних практичних навичок у проектуванні, розробці та тестуванні RESTful API, що є фундаментальними для створення сучасних розподілених додатків.
